<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Tap to Earn</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
        }
        
        .admin-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .admin-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .admin-subtitle {
            opacity: 0.8;
            font-size: 16px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #00d4ff;
            margin-bottom: 5px;
        }
        
        .stat-label {
            opacity: 0.8;
            font-size: 14px;
        }
        
        .admin-sections {
            display: grid;
            gap: 30px;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .section-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #00d4ff;
        }
        
        .user-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .user-table th,
        .user-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .user-table th {
            background: rgba(255, 255, 255, 0.1);
            font-weight: bold;
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn-danger {
            background: #ff4757;
            color: white;
        }
        
        .btn-success {
            background: #2ed573;
            color: white;
        }
        
        .btn-primary {
            background: #3742fa;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .form-input {
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            flex: 1;
            min-width: 150px;
        }
        
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .withdrawal-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #ffa726;
        }
        
        .package-config {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .package-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .access-denied {
            text-align: center;
            padding: 50px 20px;
        }
        
        .access-denied h1 {
            font-size: 48px;
            color: #ff4757;
            margin-bottom: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 50px 20px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .broadcast-section {
            margin-top: 20px;
        }

        .broadcast-textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            resize: vertical;
            font-family: inherit;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .user-table {
                font-size: 12px;
            }
            
            .user-table th,
            .user-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <h2>Loading Admin Panel...</h2>
            <p>Verifying admin access...</p>
        </div>

        <!-- Access Denied -->
        <div id="accessDenied" class="access-denied" style="display: none;">
            <h1>üö´</h1>
            <h2>Access Denied</h2>
            <p>You don't have admin privileges to access this panel.</p>
            <p>Contact the administrator if you believe this is an error.</p>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="admin-container" style="display: none;">
            <div class="header">
                <div class="admin-title">üéØ Admin Control Panel</div>
                <div class="admin-subtitle">Manage your Tap-to-Earn Mini App</div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div class="stat-label">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalRevenue">$0</div>
                    <div class="stat-label">Total Revenue</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalTaps">0</div>
                    <div class="stat-label">Total Taps</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activePackages">0</div>
                    <div class="stat-label">Active Packages</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingWithdrawals">0</div>
                    <div class="stat-label">Pending Withdrawals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalReferrals">0</div>
                    <div class="stat-label">Total Referrals</div>
                </div>
            </div>

            <!-- User Management -->
            <div class="section">
                <div class="section-title">üë• User Management</div>
                
                <div class="input-group">
                    <input type="text" class="form-input" id="searchUser" placeholder="Search by username or ID">
                    <button class="btn btn-primary" onclick="searchUsers()">üîç Search</button>
                    <button class="btn btn-success" onclick="loadAllUsers()">üìã Show All Users</button>
                </div>

                <div class="input-group">
                    <input type="number" class="form-input" id="userIdInput" placeholder="User ID">
                    <input type="number" class="form-input" id="coinsToAdd" placeholder="Coins to add">
                    <button class="btn btn-success" onclick="addCoins()">üí∞ Add Coins</button>
                    <button class="btn btn-danger" onclick="banUser()">üö´ Ban User</button>
                </div>

                <table class="user-table" id="usersTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Balance</th>
                            <th>Packages</th>
                            <th>Referrals</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- Users will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Withdrawal Management -->
            <div class="section">
                <div class="section-title">üí≥ Withdrawal Management</div>
                
                <div id="withdrawalsList">
                    <!-- Pending withdrawals will be shown here -->
                </div>

                <div class="input-group">
                    <button class="btn btn-primary" onclick="loadPendingWithdrawals()">üîÑ Refresh Withdrawals</button>
                    <button class="btn btn-success" onclick="approveAllWithdrawals()">‚úÖ Approve All</button>
                </div>
            </div>

            <!-- Package Configuration -->
            <div class="section">
                <div class="section-title">üì¶ Package Configuration</div>
                
                <div class="package-config" id="packageConfig">
                    <!-- Package configurations will be loaded here -->
                </div>

                <div class="input-group">
                    <input type="number" class="form-input" id="newPackagePrice" placeholder="Package Price ($)">
                    <input type="number" class="form-input" id="newPackageProfit" placeholder="Max Profit ($)">
                    <input type="number" class="form-input" id="newPackageDays" placeholder="Duration (days)" value="30">
                    <button class="btn btn-success" onclick="addNewPackage()">‚ûï Add Package</button>
                </div>
            </div>

            <!-- Broadcast Messages -->
            <div class="section">
                <div class="section-title">üì¢ Broadcast Message</div>
                
                <div class="broadcast-section">
                    <textarea class="broadcast-textarea" id="broadcastMessage" placeholder="Enter your message to send to all users..."></textarea>
                    
                    <div class="input-group" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="sendBroadcast()">üì§ Send to All Users</button>
                        <button class="btn btn-success" onclick="testBroadcast()">üß™ Test Message</button>
                    </div>
                </div>
            </div>

            <!-- Anti-Cheat Monitoring -->
            <div class="section">
                <div class="section-title">üõ°Ô∏è Anti-Cheat Monitoring</div>
                
                <div class="input-group">
                    <input type="number" class="form-input" id="maxTapsPerSecond" placeholder="Max taps/second" value="10">
                    <button class="btn btn-primary" onclick="updateAntiCheat()">üîß Update Settings</button>
                    <button class="btn btn-danger" onclick="findSuspiciousUsers()">üîç Find Suspicious Users</button>
                </div>

                <table class="user-table" id="suspiciousUsersTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Username</th>
                            <th>Suspicious Activity</th>
                            <th>Taps/Minute</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="suspiciousUsersBody">
                        <!-- Suspicious users will be shown here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Your Telegram ID (CHANGE THIS TO YOUR ACTUAL TELEGRAM ID)
        const ADMIN_TELEGRAM_ID = 7538805953; // üî• REPLACE WITH YOUR TELEGRAM ID!
        
        // Initialize Telegram Web App
        const tg = window.Telegram?.WebApp;
        
        // Sample data (replace with real API calls)
        let userData = {
            users: [
                { id: 1, username: "user1", balance: 150.50, packages: 2, referrals: 5, status: "active" },
                { id: 2, username: "user2", balance: 89.25, packages: 1, referrals: 2, status: "active" },
                { id: 3, username: "user3", balance: 245.00, packages: 3, referrals: 8, status: "banned" }
            ],
            withdrawals: [
                { id: 1, userId: 1, username: "user1", amount: 25.50, wallet: "UQA7X...", status: "pending" },
                { id: 2, userId: 2, username: "user2", amount: 15.00, wallet: "UQB8Y...", status: "pending" }
            ],
            packages: [
                { id: 1, price: 5, profit: 10, duration: 30, active: true },
                { id: 2, price: 25, profit: 60, duration: 30, active: true },
                { id: 3, price: 100, profit: 250, duration: 30, active: true }
            ]
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            if (tg) {
                tg.ready();
                checkAdminAccess();
            } else {
                // For testing without Telegram
                setTimeout(checkAdminAccess, 1000);
            }
        });

        function checkAdminAccess() {
            const loading = document.getElementById('loading');
            const accessDenied = document.getElementById('accessDenied');
            const adminPanel = document.getElementById('adminPanel');

            // Get user data from Telegram
            const telegramUser = tg?.initDataUnsafe?.user;
            
            // For testing purposes, you can comment out the real check and use this:
            // const isAdmin = true;
            
            const isAdmin = telegramUser && telegramUser.id === ADMIN_TELEGRAM_ID;

            setTimeout(() => {
                loading.style.display = 'none';
                
                if (isAdmin) {
                    adminPanel.style.display = 'block';
                    loadAdminData();
                } else {
                    accessDenied.style.display = 'block';
                }
            }, 2000);
        }

        function loadAdminData() {
            // Load statistics
            document.getElementById('totalUsers').textContent = userData.users.length;
            document.getElementById('totalRevenue').textContent = '$' + (userData.users.length * 75).toFixed(2);
            document.getElementById('totalTaps').textContent = (userData.users.length * 1500).toLocaleString();
            document.getElementById('activePackages').textContent = userData.users.reduce((sum, user) => sum + user.packages, 0);
            document.getElementById('pendingWithdrawals').textContent = userData.withdrawals.filter(w => w.status === 'pending').length;
            document.getElementById('totalReferrals').textContent = userData.users.reduce((sum, user) => sum + user.referrals, 0);

            // Load users
            loadAllUsers();
            loadPendingWithdrawals();
            loadPackageConfig();
        }

        function loadAllUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';

            userData.users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>$${user.balance.toFixed(2)}</td>
                    <td>${user.packages}</td>
                    <td>${user.referrals}</td>
                    <td><span style="color: ${user.status === 'active' ? '#2ed573' : '#ff4757'}">${user.status.toUpperCase()}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="viewUserDetails(${user.id})">üëÅÔ∏è View</button>
                        <button class="btn btn-${user.status === 'active' ? 'danger' : 'success'}" onclick="toggleUserStatus(${user.id})">
                            ${user.status === 'active' ? 'üö´ Ban' : '‚úÖ Unban'}
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadPendingWithdrawals() {
            const container = document.getElementById('withdrawalsList');
            container.innerHTML = '';

            const pendingWithdrawals = userData.withdrawals.filter(w => w.status === 'pending');

            if (pendingWithdrawals.length === 0) {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">No pending withdrawals</p>';
                return;
            }

            pendingWithdrawals.forEach(withdrawal => {
                const card = document.createElement('div');
                card.className = 'withdrawal-card';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                        <div>
                            <strong>${withdrawal.username}</strong> (ID: ${withdrawal.userId})<br>
                            Amount: <strong>$${withdrawal.amount}</strong><br>
                            Wallet: <code>${withdrawal.wallet}</code>
                        </div>
                        <div>
                            <button class="btn btn-success" onclick="approveWithdrawal(${withdrawal.id})">‚úÖ Approve</button>
                            <button class="btn btn-danger" onclick="rejectWithdrawal(${withdrawal.id})">‚ùå Reject</button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function loadPackageConfig() {
            const container = document.getElementById('packageConfig');
            container.innerHTML = '';

            userData.packages.forEach(pkg => {
                const card = document.createElement('div');
                card.className = 'package-card';
                card.innerHTML = `
                    <h4>Package #${pkg.id}</h4>
                    <p><strong>Price:</strong> $${pkg.price}</p>
                    <p><strong>Max Profit:</strong> $${pkg.profit}</p>
                    <p><strong>Duration:</strong> ${pkg.duration} days</p>
                    <p><strong>Status:</strong> <span style="color: ${pkg.active ? '#2ed573' : '#ff4757'}">${pkg.active ? 'Active' : 'Inactive'}</span></p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="editPackage(${pkg.id})">‚úèÔ∏è Edit</button>
                        <button class="btn btn-${pkg.active ? 'danger' : 'success'}" onclick="togglePackage(${pkg.id})">
                            ${pkg.active ? 'üö´ Disable' : '‚úÖ Enable'}
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Admin Functions
        function searchUsers() {
            const searchTerm = document.getElementById('searchUser').value.toLowerCase();
            const filteredUsers = userData.users.filter(user => 
                user.username.toLowerCase().includes(searchTerm) || 
                user.id.toString().includes(searchTerm)
            );
            
            displayUsers(filteredUsers);
        }

        function displayUsers(users) {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';

            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>$${user.balance.toFixed(2)}</td>
                    <td>${user.packages}</td>
                    <td>${user.referrals}</td>
                    <td><span style="color: ${user.status === 'active' ? '#2ed573' : '#ff4757'}">${user.status.toUpperCase()}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="viewUserDetails(${user.id})">üëÅÔ∏è View</button>
                        <button class="btn btn-${user.status === 'active' ? 'danger' : 'success'}" onclick="toggleUserStatus(${user.id})">
                            ${user.status === 'active' ? 'üö´ Ban' : '‚úÖ Unban'}
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function addCoins() {
            const userId = document.getElementById('userIdInput').value;
            const coins = parseFloat(document.getElementById('coinsToAdd').value);
            
            if (!userId || !coins) {
                alert('Please enter both User ID and amount of coins!');
                return;
            }

            // In real app, make API call here
            const user = userData.users.find(u => u.id == userId);
            if (user) {
                user.balance += coins;
                loadAllUsers();
                alert(`‚úÖ Added $${coins} to ${user.username}'s account!`);
                
                // Clear inputs
                document.getElementById('userIdInput').value = '';
                document.getElementById('coinsToAdd').value = '';
            } else {
                alert('‚ùå User not found!');
            }
        }

        function banUser() {
            const userId = document.getElementById('userIdInput').value;
            
            if (!userId) {
                alert('Please enter User ID!');
                return;
            }

            // In real app, make API call here
            const user = userData.users.find(u => u.id == userId);
            if (user) {
                user.status = user.status === 'active' ? 'banned' : 'active';
                loadAllUsers();
                alert(`‚úÖ User ${user.username} has been ${user.status === 'banned' ? 'banned' : 'unbanned'}!`);
                
                document.getElementById('userIdInput').value = '';
            } else {
                alert('‚ùå User not found!');
            }
        }

        function approveWithdrawal(withdrawalId) {
            // In real app, make API call here
            const withdrawal = userData.withdrawals.find(w => w.id === withdrawalId);
            if (withdrawal) {
                withdrawal.status = 'approved';
                loadPendingWithdrawals();
                alert(`‚úÖ Withdrawal of $${withdrawal.amount} for ${withdrawal.username} approved!`);
            }
        }

        function rejectWithdrawal(withdrawalId) {
            // In real app, make API call here
            const withdrawal = userData.withdrawals.find(w => w.id === withdrawalId);
            if (withdrawal) {
                withdrawal.status = 'rejected';
                loadPendingWithdrawals();
                alert(`‚ùå Withdrawal rejected for ${withdrawal.username}`);
            }
        }

        function approveAllWithdrawals() {
            if (confirm('Are you sure you want to approve ALL pending withdrawals?')) {
                userData.withdrawals.forEach(w => {
                    if (w.status === 'pending') {
                        w.status = 'approved';
                    }
                });
                loadPendingWithdrawals();
                alert('‚úÖ All withdrawals approved!');
            }
        }

        function sendBroadcast() {
            const message = document.getElementById('broadcastMessage').value;
            
            if (!message.trim()) {
                alert('Please enter a message!');
                return;
            }

            if (confirm(`Send this message to all ${userData.users.length} users?\n\n"${message}"`)) {
                // In real app, make API call here
                alert(`‚úÖ Message sent to ${userData.users.length} users!`);
                document.getElementById('broadcastMessage').value = '';
            }
        }

        function testBroadcast() {
            const message = document.getElementById('broadcastMessage').value;
            
            if (!message.trim()) {
                alert('Please enter a message!');
                return;
            }

            alert(`üì§ Test Message Preview:\n\n${message}`);
        }

        function addNewPackage() {
            const price = parseFloat(document.getElementById('newPackagePrice').value);
            const profit = parseFloat(document.getElementById('newPackageProfit').value);
            const days = parseInt(document.getElementById('newPackageDays').value);

            if (!price || !profit || !days) {
                alert('Please fill in all package details!');
                return;
            }

            const newPackage = {
                id: userData.packages.length + 1,
                price: price,
                profit: profit,
                duration: days,
                active: true
            };

            userData.packages.push(newPackage);
            loadPackageConfig();
            
            // Clear inputs
            document.getElementById('newPackagePrice').value = '';
            document.getElementById('newPackageProfit').value = '';
            document.getElementById('newPackageDays').value = '30';
            
            alert(`‚úÖ New package created: $${price} ‚Üí $${profit} (${days} days)`);
        }

        function togglePackage(packageId) {
            const pkg = userData.packages.find(p => p.id === packageId);
            if (pkg) {
                pkg.active = !pkg.active;
                loadPackageConfig();
                alert(`‚úÖ Package #${packageId} ${pkg.active ? 'enabled' : 'disabled'}!`);
            }
        }

        function updateAntiCheat() {
            const maxTaps = document.getElementById('maxTapsPerSecond').value;
            
            if (!maxTaps) {
                alert('Please enter maximum taps per second!');
                return;
            }

            // In real app, save to database/config
            alert(`‚úÖ Anti-cheat updated: Maximum ${maxTaps} taps per second`);
        }

        function findSuspiciousUsers() {
            // Simulate finding suspicious users
            const suspiciousUsers = [
                { id: 5, username: "suspicious_user1", activity: "Too fast tapping", tapsPerMinute: 1200 },
                { id: 8, username: "bot_user", activity: "Consistent timing", tapsPerMinute: 600 }
            ];

            const table = document.getElementById('suspiciousUsersTable');
            const tbody = document.getElementById('suspiciousUsersBody');
            
            tbody.innerHTML = '';
            
            if (suspiciousUsers.length > 0) {
                suspiciousUsers.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${user.id}</td>
                        <td>${user.username}</td>
                        <td>${user.activity}</td>
                        <td style="color: #ff4757; font-weight: bold;">${user.tapsPerMinute}</td>
                        <td>
                            <button class="btn btn-danger" onclick="banSuspiciousUser(${user.id})">üö´ Ban</button>
                            <button class="btn btn-primary" onclick="viewUserDetails(${user.id})">üëÅÔ∏è Investigate</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                table.style.display = 'table';
                alert(`‚ö†Ô∏è Found ${suspiciousUsers.length} suspicious users!`);
            } else {
                alert('‚úÖ No suspicious activity detected!');
                table.style.display = 'none';
            }
        }

        function banSuspiciousUser(userId) {
            if (confirm(`Ban user ID ${userId} for suspicious activity?`)) {
                // In real app, make API call here
                alert(`‚úÖ User ${userId} has been banned for suspicious activity!`);
                findSuspiciousUsers(); // Refresh the list
            }
        }

        function viewUserDetails(userId) {
            const user = userData.users.find(u => u.id === userId);
            if (user) {
                const details = `
üë§ User Details:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ID: ${user.id}
Username: ${user.username}
Balance: ${user.balance.toFixed(2)}
Active Packages: ${user.packages}
Total Referrals: ${user.referrals}
Account Status: ${user.status.toUpperCase()}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
                `.trim();
                
                alert(details);
            } else {
                alert('‚ùå User not found!');
            }
        }

        function toggleUserStatus(userId) {
            const user = userData.users.find(u => u.id === userId);
            if (user) {
                const action = user.status === 'active' ? 'ban' : 'unban';
                if (confirm(`Are you sure you want to ${action} ${user.username}?`)) {
                    user.status = user.status === 'active' ? 'banned' : 'active';
                    loadAllUsers();
                    alert(`‚úÖ User ${user.username} has been ${user.status === 'banned' ? 'banned' : 'unbanned'}!`);
                }
            }
        }

        function editPackage(packageId) {
            const pkg = userData.packages.find(p => p.id === packageId);
            if (pkg) {
                const newPrice = prompt(`Enter new price for Package #${packageId}:`, pkg.price);
                const newProfit = prompt(`Enter new max profit for Package #${packageId}:`, pkg.profit);
                const newDuration = prompt(`Enter new duration (days) for Package #${packageId}:`, pkg.duration);
                
                if (newPrice && newProfit && newDuration) {
                    pkg.price = parseFloat(newPrice);
                    pkg.profit = parseFloat(newProfit);
                    pkg.duration = parseInt(newDuration);
                    loadPackageConfig();
                    alert(`‚úÖ Package #${packageId} updated successfully!`);
                }
            }
        }

        // Helper function to format numbers
        function formatNumber(num) {
            return new Intl.NumberFormat().format(num);
        }

        // Helper function to format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD'
            }).format(amount);
        }

        // Auto-refresh data every 30 seconds
        setInterval(() => {
            if (document.getElementById('adminPanel').style.display !== 'none') {
                console.log('üîÑ Auto-refreshing admin data...');
                // In real app, fetch fresh data from API
                loadAdminData();
            }
        }, 30000);

        // Show success/error messages
        function showMessage(message, type = 'success') {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 9999;
                animation: slideIn 0.3s ease-out;
                background: ${type === 'success' ? '#2ed573' : '#ff4757'};
            `;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // Add CSS animation for messages
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
